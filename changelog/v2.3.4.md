# Version 2.3.4 - October 20, 2025

## Fixed

### Build System
- **TypeScript Compilation Errors** - Fixed multiple TypeScript errors preventing production builds:
  - Fixed deprecated Next.js API route config export in media upload handler
  - Fixed React Hooks rules violations (hooks called conditionally after early returns)
  - Added proper optional chaining for session null checks across API routes
  - Fixed TypeScript type inference issues for database query results
  - Fixed Set/Map iteration compatibility with ES5 target using `Array.from()`
  - Fixed image dimension type assertions in media processing

### API Routes
- **Session Handling** - Added consistent optional chaining (`?.`) for session checks across all API routes
- **Media Upload** - Removed deprecated `export const config` that caused Next.js build failures
- **Media Regeneration** - Fixed Set iteration and session type checks
- **Sites Management** - Fixed session null checks in create, update, and delete operations
- **Post Types** - Fixed mutation response handling in empty trash operation

### Admin UI
- **Settings Pages** - Fixed React Hooks order violations in Global Settings and Sites pages
- **Post Management** - Fixed TypeScript errors in dashboard post type mapping
- **Dashboard** - Added proper type casting for post type labels

### Database
- **Query Utilities** - Fixed type annotations in post-utils slug path builder

## Changed

### Test Suite
- Updated API implementation documentation with Sites and Settings endpoints
- Added comprehensive test coverage for multi-site management (118 total API tests)

## Summary

Version 2.3.4 is a maintenance release that fixes critical build errors introduced in recent API additions. All TypeScript compilation errors have been resolved, and the project now builds successfully for production deployment. The fixes primarily focus on proper TypeScript typing, React Hooks compliance, and Next.js 14 compatibility while maintaining all existing functionality from the Headless API implementation.

